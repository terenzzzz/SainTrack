import{_ as te}from"../../assets/index-3d7a7aa0.js";import{f as H,al as m,o as i,c as L,R as t,J as s,a as e,P as u,Q as K,a4 as ee,I as g,O as d,r as A,w as se,t as ne,X as ae,M as y,C as re}from"../@vue/@vue.f1ada3fe.js";const oe={class:"shipping-info"},ie={class:"content-wrapper"},ue={class:"text-wrapper"},de={class:"value"},ce={class:"text-wrapper"},pe={class:"text-wrapper"},_e={class:"value"},me={class:"text-wrapper"},fe={class:"value"},ve={class:"text-wrapper"},ge={class:"value"},ye={class:"receiver-info"},we={class:"customer"},be={class:"left"},he={class:"d-flex flex-column"},ke={class:"right"},xe={class:"content-wrapper"},Oe={class:"text-wrapper"},Se={class:"value"},Ce={class:"text-wrapper"},Te={class:"value"},De={class:"text-wrapper"},$e={class:"value"},Ve={class:"shipment-info"},Ie={class:"timeline-content"},Le={class:"order-product"},je={__name:"TrackingModal",props:{currentOrder:{type:Object,required:!0}},setup(p){const W=p,R=H(()=>{var v,c,U,_,D,B,T,E,f,O;const j=(D=(_=(U=(c=(v=W.currentOrder)==null?void 0:v.shipments)==null?void 0:c[0])==null?void 0:U.trackings)==null?void 0:_[0])==null?void 0:D.tracking_data;if(!j)return[];let l={};try{l=JSON.parse(j)}catch(x){return console.error("Invalid tracking_data",x),[]}return(((O=(f=(E=(T=(B=l.data)==null?void 0:B.track_info)==null?void 0:T.tracking)==null?void 0:E.providers)==null?void 0:f[0])==null?void 0:O.events)||[]).slice().map(x=>({time:x.time_iso||"Unknown",done:!!x.time_iso,content:x.description||"No info",location:x.location||"Unknown",details:x.stage||"-"}))}),q=j=>{if(!j)return;const l=`https://t.17track.net/en#nums=${j}`;window.open(l,"_blank")};return(j,l)=>{const J=m("el-avatar"),v=m("Phone"),c=m("el-icon"),U=m("Message"),_=m("el-col"),D=m("el-timeline-item"),B=m("el-timeline"),T=m("el-row"),E=m("el-image");return i(),L(K,null,[t(T,{gutter:24},{default:s(()=>[t(_,{md:24,lg:12,class:"sticky order-warpeer"},{default:s(()=>{var f,O,x,Q,a,n,$,S,o,w,h,V;return[e("div",oe,[l[7]||(l[7]=e("div",{class:"d-flex title-wrapper"},[e("h3",{class:"h3"},"Shipping Info")],-1)),e("div",ie,[e("div",ue,[l[1]||(l[1]=e("p",{class:"label"},"Order number",-1)),e("p",de,u(p.currentOrder.channel_order_id||"—"),1)]),e("div",ce,[l[2]||(l[2]=e("p",{class:"label"},"Tracking number",-1)),e("p",{class:"value link",onClick:l[0]||(l[0]=N=>{var b,P;return q((P=(b=p.currentOrder.shipments)==null?void 0:b[0])==null?void 0:P.tracking)})},u(((O=(f=p.currentOrder.shipments)==null?void 0:f[0])==null?void 0:O.tracking)||"-"),1)]),e("div",pe,[l[3]||(l[3]=e("p",{class:"label"},"Courier",-1)),e("p",_e,u(((Q=(x=p.currentOrder.shipments)==null?void 0:x[0])==null?void 0:Q.carrier)||"—"),1)]),e("div",me,[l[4]||(l[4]=e("p",{class:"label"},"Weight",-1)),e("p",fe,u(((n=(a=p.currentOrder.shipments)==null?void 0:a[0])==null?void 0:n.total_weight_kg)||"—")+" KG",1)]),e("div",ve,[l[5]||(l[5]=e("p",{class:"label"},"Price",-1)),e("p",ge,"$ "+u(p.currentOrder.subtotal||"—"),1)]),l[6]||(l[6]=e("div",{class:"text-wrapper"},[e("p",{class:"label"},"Estimated Delivery"),e("p",{class:"value"},"—")],-1))])]),e("div",ye,[l[11]||(l[11]=e("h3",{class:"h3"},"Receiver Info",-1)),e("div",we,[e("div",be,[t(J,{size:50,src:`https://ui-avatars.com/api/?name=${p.currentOrder.channel_customer_id}&rounded=true`},null,8,["src"]),e("div",he,[e("strong",null,u(p.currentOrder.channel_customer_id),1),e("p",null,u(p.currentOrder.email),1)])]),e("div",ke,[t(c,{size:"20",class:"icon"},{default:s(()=>[t(v)]),_:1}),t(c,{size:"20",class:"icon"},{default:s(()=>[t(U)]),_:1})])]),e("div",xe,[e("div",Oe,[l[8]||(l[8]=e("p",{class:"label"},"Destination",-1)),e("p",Se,u((S=($=p.currentOrder.shipments)==null?void 0:$[0])==null?void 0:S.dest_country),1)]),e("div",Ce,[l[9]||(l[9]=e("p",{class:"label"},"Zipcode",-1)),e("p",Te,u(((w=(o=p.currentOrder.shipments)==null?void 0:o[0])==null?void 0:w.dest_zipcode)||"-"),1)]),e("div",De,[l[10]||(l[10]=e("p",{class:"label"},"Address",-1)),e("p",$e,u((V=(h=p.currentOrder.shipments)==null?void 0:h[0])==null?void 0:V.dest_address1),1)])])])]}),_:1}),t(_,{md:24,lg:12,class:"sticky tracking-wrapper"},{default:s(()=>[e("div",Ve,[l[14]||(l[14]=e("h3",{class:"h3"},"Route Details",-1)),t(B,null,{default:s(()=>[(i(!0),L(K,null,ee(R.value,(f,O)=>(i(),g(D,{key:O,timestamp:f.time,color:f.done?"green":"gray"},{default:s(()=>[e("div",Ie,[e("p",null,[e("strong",null,u(f.content),1)]),e("p",null,[l[12]||(l[12]=e("em",null,"Location:",-1)),d(" "+u(f.location),1)]),e("p",null,[l[13]||(l[13]=e("em",null,"Details:",-1)),d(" "+u(f.details),1)])])]),_:2},1032,["timestamp","color"]))),128))]),_:1})])]),_:1})]),_:1}),t(T,null,{default:s(()=>[t(_,{span:24},{default:s(()=>[e("div",Le,[t(T,{class:"heading"},{default:s(()=>[t(_,{span:4},{default:s(()=>[...l[15]||(l[15]=[d(" Product ",-1)])]),_:1}),t(_,{span:8,class:"text-center"},{default:s(()=>[...l[16]||(l[16]=[d("Title",-1)])]),_:1}),t(_,{span:4,class:"text-center"},{default:s(()=>[...l[17]||(l[17]=[d("sku",-1)])]),_:1}),t(_,{span:4,class:"text-center"},{default:s(()=>[...l[18]||(l[18]=[d("Quantity",-1)])]),_:1}),t(_,{span:4,class:"text-center"},{default:s(()=>[...l[19]||(l[19]=[d("Price",-1)])]),_:1})]),_:1}),(i(!0),L(K,null,ee(p.currentOrder.order_items,(f,O)=>(i(),g(T,{class:"product-row",key:O,style:{"margin-bottom":"20px"}},{default:s(()=>[t(_,{span:4,class:"text-center product"},{default:s(()=>[t(E,{src:f.img?f.img:"https://cdn.shopify.com/s/files/1/1771/9275/products/AD5I9768.jpg?v=1665652917",style:{width:"100px",height:"100px"},fit:"cover",class:"product-img"},null,8,["src"])]),_:2},1024),t(_,{span:8,class:"text-center"},{default:s(()=>[d(u(f.listing||"-"),1)]),_:2},1024),t(_,{span:4,class:"text-center"},{default:s(()=>[d(u(f.sku||"-"),1)]),_:2},1024),t(_,{span:4,class:"text-center"},{default:s(()=>[d(u(f.quantity||"-"),1)]),_:2},1024),t(_,{span:4,class:"text-center"},{default:s(()=>[d(u(f.price||"-"),1)]),_:2},1024)]),_:2},1024))),128)),t(T,{class:"footer"},{default:s(()=>[t(_,{span:16},{default:s(()=>[...l[20]||(l[20]=[d(" Total ",-1)])]),_:1}),t(_,{span:4}),t(_,{span:4,class:"text-center"},{default:s(()=>[d("$ "+u(p.currentOrder.total),1)]),_:1})]),_:1})])]),_:1})]),_:1})],64)}}},Me=te(je,[["__scopeId","data-v-41ac3195"]]);const Re={class:"container"},Ue={key:1,class:"d-flex justify-center"},Be={class:"table-wrapper"},Ee={key:0,class:"d-flex justify-between align-center"},Pe={class:"h3"},Ae={key:0},Ne={key:1},ze={key:1},Fe={style:{"text-align":"center"}},We={style:{display:"flex","justify-content":"center"}},qe={style:{display:"flex","justify-content":"center",width:"100%"}},Je={__name:"ShipmentTable",props:{showActions:{type:Boolean,default:!0},columns:{type:Array,default:()=>["store","order_no","customer_name","courier","tracking_no","latest_status","status","delivery_status","created_at","operations"]},maxRows:{type:Number,default:50},showViewMore:{type:Boolean,default:!1},orderList:{type:Object,default:()=>({order_list:[]})},tableTitle:{type:String,default:"Order"},tableIcon:{type:String,default:""}},setup(p){const W=A(null),R=p,q=A([]);function j(a,n){return new Date(a.created_at).getTime()-new Date(n.created_at).getTime()}se(()=>R.orderList,a=>{var n;q.value=((n=a==null?void 0:a.order_list)==null?void 0:n[0])||[]},{immediate:!0});const l=A(!1),J=A(null),v=A({order_no:"",customer_name:"",status:"",delivery_status:""}),c=H(()=>{const a={};for(const n of R.columns)a[n]=!0;return a}),U=H(()=>q.value.filter(a=>{var h,V,N,b,P,z,G;const n=String(a.order_no||"").includes(v.value.order_no||""),$=String(a.customer_name||"").includes(v.value.customer_name||""),S=v.value.status?((h=a.fulfillment_status)==null?void 0:h.toLowerCase())===((V=v.value.status)==null?void 0:V.toLowerCase()):!0,o=(z=(P=(b=(N=a.shipments)==null?void 0:N[0])==null?void 0:b.trackings)==null?void 0:P[0])==null?void 0:z.status,w=v.value.delivery_status?(o==null?void 0:o.toLowerCase())===((G=v.value.delivery_status)==null?void 0:G.toLowerCase()):!0;return n&&$&&S&&w}).slice(0,R.maxRows)),_=a=>{J.value=a,W.value=a,l.value=!0},D=A(window.innerWidth),B=()=>{D.value=window.innerWidth};ne(()=>{window.addEventListener("resize",B)}),ae(()=>{window.removeEventListener("resize",B)});const T=H(()=>D.value<=768?"95%":D.value<=1e3?"80%":D.value<=1300?"70%":"50%"),E=a=>{const n=a.tracking_history||[];return n.length?n[n.length-1].info:"No info"},f=a=>{if(!a)return"info";switch(a.toLowerCase()){case"fulfilled":return"success";case"partially_fulfilled":return"warning";case"in_progress":case"pending_fulfillment":return"primary";case"on_hold":case"request_declined":return"danger";case"open":case"unfulfilled":case"scheduled":case"restocked":return"warning";case"shipped":return"success";default:return"info"}},O=a=>{switch(a){case"Delivered":return"success";case"InTransit":return"primary";case"InfoReceived":return"info";case"Exception":return"danger";case"Cancelled":return"danger";default:return"info"}},x=a=>{if(!a)return;const n=`https://t.17track.net/en#nums=${a}`;window.open(n,"_blank")},Q=()=>{const a=R.columns.filter(w=>c.value[w]).map(w=>w.replace(/_/g," ").replace(/\b\w/g,h=>h.toUpperCase())),n=U.value.map(w=>R.columns.filter(h=>c.value[h]).map(h=>h==="latest_status"?E(w):h==="operations"?"":w[h]||"")),$=[a,...n].map(w=>w.join(",")).join(`
`),S=new Blob([$],{type:"text/csv;charset=utf-8;"}),o=document.createElement("a");o.href=URL.createObjectURL(S),o.setAttribute("download","orders.csv"),o.click()};return(a,n)=>{const $=m("el-input"),S=m("el-col"),o=m("el-option"),w=m("el-select"),h=m("el-row"),V=m("el-button"),N=m("router-link"),b=m("el-table-column"),P=m("el-link"),z=m("el-tag"),G=m("el-table"),le=m("el-dialog");return i(),L("div",Re,[p.showActions?(i(),g(h,{key:0,gutter:20,class:"actions-wrapper"},{default:s(()=>[c.value.order_no?(i(),g(S,{key:0,span:5},{default:s(()=>[n[5]||(n[5]=e("p",{class:"label"},"Search OrderID:",-1)),t($,{modelValue:v.value.order_no,"onUpdate:modelValue":n[0]||(n[0]=r=>v.value.order_no=r),placeholder:"Search Order ID",clearable:""},null,8,["modelValue"])]),_:1})):y("",!0),c.value.customer_name?(i(),g(S,{key:1,span:4},{default:s(()=>[n[6]||(n[6]=e("p",{class:"label"},"Search Customer:",-1)),t($,{modelValue:v.value.customer_name,"onUpdate:modelValue":n[1]||(n[1]=r=>v.value.customer_name=r),placeholder:"Search Customer",clearable:""},null,8,["modelValue"])]),_:1})):y("",!0),c.value.status?(i(),g(S,{key:2,span:4},{default:s(()=>[n[7]||(n[7]=e("p",{class:"label"},"Filter by Order Status:",-1)),t(w,{modelValue:v.value.status,"onUpdate:modelValue":n[2]||(n[2]=r=>v.value.status=r),placeholder:"Select Order Status",clearable:""},{default:s(()=>[t(o,{label:"Fulfilled",value:"fulfilled"}),t(o,{label:"Partially Fulfilled",value:"partially_fulfilled"}),t(o,{label:"In Progress",value:"in_progress"}),t(o,{label:"Pending Fulfillment",value:"pending_fulfillment"}),t(o,{label:"On Hold",value:"on_hold"}),t(o,{label:"Request Declined",value:"request_declined"}),t(o,{label:"Open",value:"open"}),t(o,{label:"Unfulfilled",value:"unfulfilled"}),t(o,{label:"Scheduled",value:"scheduled"}),t(o,{label:"Restocked",value:"restocked"}),t(o,{label:"Shipped",value:"shipped"})]),_:1},8,["modelValue"])]),_:1})):y("",!0),c.value.delivery_status?(i(),g(S,{key:3,span:4},{default:s(()=>[n[8]||(n[8]=e("p",{class:"label"},"Filter by Delivery Status:",-1)),t(w,{modelValue:v.value.delivery_status,"onUpdate:modelValue":n[3]||(n[3]=r=>v.value.delivery_status=r),placeholder:"Select Delivery Status",clearable:""},{default:s(()=>[t(o,{label:"Delivered",value:"Delivered"}),t(o,{label:"In Transit",value:"InTransit"}),t(o,{label:"Info Received",value:"InfoReceived"}),t(o,{label:"Exception",value:"Exception"}),t(o,{label:"Cancelled",value:"Cancelled"})]),_:1},8,["modelValue"])]),_:1})):y("",!0)]),_:1})):y("",!0),p.showActions?(i(),L("div",Ue,[t(V,{type:"info",disabled:""},{default:s(()=>[...n[9]||(n[9]=[d("Import from CSV",-1)])]),_:1}),t(V,{type:"primary",onClick:Q},{default:s(()=>[...n[10]||(n[10]=[d("Export to CSV",-1)])]),_:1})])):y("",!0),e("div",Be,[p.showViewMore?(i(),L("div",Ee,[e("h3",Pe,[re(a.$slots,"icon",{},void 0,!0),d(" "+u(p.tableTitle),1)]),t(N,{to:{name:"Orders"},class:"link"},{default:s(()=>[...n[11]||(n[11]=[d(" View More ",-1)])]),_:1})])):y("",!0),t(G,{data:U.value,"tooltip-effect":"dark",style:{width:"100%",height:"100%"},"default-sort":{prop:"created_at",order:"descending"}},{default:s(()=>[c.value.store?(i(),g(b,{key:0,label:"Store",width:"150",align:"left",sortable:""},{default:s(r=>{var k;return[d(u(((k=r.row.channel_seller_id)==null?void 0:k.split(".")[0])||"—"),1)]}),_:1})):y("",!0),c.value.order_no?(i(),g(b,{key:1,prop:"channel_order_id",label:"Order ID","min-width":"150",align:"center",sortable:""})):y("",!0),c.value.customer_name?(i(),g(b,{key:2,prop:"channel_customer_id",label:"Customer","min-width":"120",align:"left",sortable:""})):y("",!0),c.value.courier?(i(),g(b,{key:3,label:"Courier",width:"120",align:"left"},{default:s(r=>{var k,M,I,C;return[(M=(k=r.row.shipments)==null?void 0:k[0])!=null&&M.carrier?(i(),L("div",Ae,u((C=(I=r.row.shipments)==null?void 0:I[0])==null?void 0:C.carrier),1)):(i(),L("span",Ne,"—"))]}),_:1})):y("",!0),c.value.tracking_no?(i(),g(b,{key:4,label:"Tracking No","min-width":"180"},{default:s(r=>{var k,M;return[e("div",null,[(M=(k=r.row.shipments)==null?void 0:k[0])!=null&&M.tracking?(i(),g(P,{key:0,type:"primary",onClick:I=>{var C,F;return x((F=(C=r.row.shipments)==null?void 0:C[0])==null?void 0:F.tracking)}},{default:s(()=>{var I,C;return[d(u((C=(I=r.row.shipments)==null?void 0:I[0])==null?void 0:C.tracking),1)]}),_:2},1032,["onClick"])):(i(),L("span",ze,"—"))])]}),_:1})):y("",!0),c.value.latest_status?(i(),g(b,{key:5,label:"Latest Status","min-width":"200",align:"left","show-overflow-tooltip":""},{default:s(r=>[e("div",Fe,u(E(r.row)),1)]),_:1})):y("",!0),c.value.status?(i(),g(b,{key:6,label:"Order Status",width:"150"},{default:s(r=>[e("div",We,[t(z,{type:f(r.row.fulfillment_status)},{default:s(()=>{var k;return[d(u(((k=r.row.fulfillment_status)==null?void 0:k.toUpperCase())||"—"),1)]}),_:2},1032,["type"])])]),_:1})):y("",!0),c.value.delivery_status?(i(),g(b,{key:7,label:"Delivery Status",width:"150"},{default:s(r=>{var k,M,I,C;return[e("div",qe,[t(z,{type:O((C=(I=(M=(k=r.row.shipments)==null?void 0:k[0])==null?void 0:M.trackings)==null?void 0:I[0])==null?void 0:C.status),style:{display:"flex","justify-content":"left"}},{default:s(()=>{var F,X,Z,Y;return[d(u(((Y=(Z=(X=(F=r.row.shipments)==null?void 0:F[0])==null?void 0:X.trackings)==null?void 0:Z[0])==null?void 0:Y.status)||"-"),1)]}),_:2},1032,["type"])])]}),_:1})):y("",!0),c.value.created_at?(i(),g(b,{key:8,label:"Created At","min-width":"200",align:"left",sortable:"","sort-method":j},{default:s(r=>[d(u(r.row.created_at),1)]),_:1})):y("",!0),c.value.operations?(i(),g(b,{key:9,label:"Operations",width:"120",align:"left"},{default:s(r=>[t(V,{type:"primary",size:"small",onClick:k=>_(r.row)},{default:s(()=>[...n[12]||(n[12]=[d("View",-1)])]),_:2},1032,["onClick"])]),_:1})):y("",!0)]),_:1},8,["data"]),t(le,{"model-value":l.value,width:T.value,"custom-class":"responsive-dialog",onClose:n[4]||(n[4]=r=>l.value=!1)},{default:s(()=>[t(Me,{"current-order":W.value},null,8,["current-order"])]),_:1},8,["model-value","width"])])])}}},He=te(Je,[["__scopeId","data-v-2c81bc2f"]]);export{He as S};
