import{E as g}from"../order/order.b9aa38ee.js";import{_ as h}from"../../assets/index-b06ef260.js";import{r as v,f as j,t as C,al as c,o as S,c as V,a as o,R as t,J as s,O as d,P as T}from"../@vue/@vue.f1ada3fe.js";import"../element-plus/element-plus.582edd78.js";import"../lodash-es/lodash-es.741e4bc3.js";import"../@element-plus/@element-plus.41fc00c7.js";import"../@popperjs/@popperjs.c75af06c.js";import"../@ctrl/@ctrl.f8748455.js";import"../dayjs/dayjs.b359c3c4.js";import"../clipboard/clipboard.45ef5b9b.js";import"../async-validator/async-validator.dee29e8b.js";import"../memoize-one/memoize-one.297ddbcb.js";import"../normalize-wheel-es/normalize-wheel-es.ed76fb12.js";import"../@floating-ui/@floating-ui.1ea5e47f.js";import"../pinia/pinia.680ff890.js";import"../js-cookie/js-cookie.edb2da2a.js";import"../axios/axios.4a70c6fc.js";import"../@codemirror/@codemirror.105aab08.js";import"../@lezer/@lezer.53ecb665.js";import"../crelt/crelt.7bb88e1d.js";import"../@marijn/@marijn.45184d7f.js";import"../style-mod/style-mod.ab9c37a6.js";import"../w3c-keyname/w3c-keyname.9fb136d3.js";import"../vue-router/vue-router.76444184.js";import"../path-to-regexp/path-to-regexp.6c7b4327.js";import"../fuse.js/fuse.js.88e2763d.js";import"../path-browserify/path-browserify.cb69e156.js";import"../screenfull/screenfull.b3e6dc1f.js";import"../vue-i18n/vue-i18n.187cabd5.js";import"../@intlify/@intlify.771bffe6.js";import"../mitt/mitt.f7ef348c.js";import"../@vueuse/@vueuse.a490c7b0.js";import"../nprogress/nprogress.6ec30c0f.js";/* empty css                                 */import"../xe-utils/xe-utils.78945774.js";import"../vxe-table/vxe-table.5c5e0e8d.js";import"../vue3-lottie/vue3-lottie.108a33f7.js";import"../lottie-web/lottie-web.88e5cf38.js";const H={class:"container"},$={class:"d-flex justify-center"},B={class:"table-wrapper"},I={__name:"HistoryTable",setup(N){const _=v([]),a=v({order_no:"",customer_name:"",email:"",status:"",notification_name:"",content:""}),b=j(()=>_.value.filter(n=>{const e=n.order_id.toLowerCase().includes(a.value.order_no.toLowerCase()),l=n.customer_name.toLowerCase().includes(a.value.customer_name.toLowerCase()),m=n.email.toLowerCase().includes(a.value.email.toLowerCase()),p=a.value.status?n.status===a.value.status:!0,i=a.value.notification_name?n.notification_name===a.value.notification_name:!0;return e&&l&&m&&p&&i})),r=v(!1),y=v(null),E=v(null),L=n=>{E.value=n,y.value=n,r.value=!0};C(async()=>{try{const e=(await g()).data.email_list||[];_.value=e.flat().map(l=>({store:l.store||"",order_id:l.order_id||l.order_guid||"",customer_name:l.customer_name||"",email:l.email||"",notification_name:l.notification_name||"Shipping Notification",status:l.status||"",created_at:l.created_at||"",content:l.content||""})),console.log("emailList:",_.value)}catch(n){console.error("获取邮件列表失败:",n.message)}});const O=()=>{const n=["Store","Order No","Customer Name","Email","Notification Name","Status","Sent At"],e=b.value.map(i=>[i.store,i.order_id,i.customer_name,i.email,i.notification_name,i.status,i.created_at]),l=[n,...e].map(i=>i.join(",")).join(`
`),m=new Blob([l],{type:"text/csv;charset=utf-8;"}),p=document.createElement("a");p.href=URL.createObjectURL(m),p.download="email_history.csv",p.click()};return(n,e)=>{const l=c("el-input"),m=c("el-col"),p=c("el-option"),i=c("el-select"),k=c("el-row"),w=c("el-button"),f=c("el-table-column"),x=c("el-tag"),R=c("el-table"),U=c("el-dialog");return S(),V("div",H,[e[13]||(e[13]=o("h3",{class:"h3 justify-center"},"Email History",-1)),t(k,{gutter:20,class:"actions-wrapper justify-center"},{default:s(()=>[t(m,{span:4},{default:s(()=>[e[5]||(e[5]=o("p",{class:"label"},"Search Order No:",-1)),t(l,{modelValue:a.value.order_no,"onUpdate:modelValue":e[0]||(e[0]=u=>a.value.order_no=u),placeholder:"Enter Order No",clearable:""},null,8,["modelValue"])]),_:1}),t(m,{span:4},{default:s(()=>[e[6]||(e[6]=o("p",{class:"label"},"Search Customer:",-1)),t(l,{modelValue:a.value.customer_name,"onUpdate:modelValue":e[1]||(e[1]=u=>a.value.customer_name=u),placeholder:"Enter Customer Name",clearable:""},null,8,["modelValue"])]),_:1}),t(m,{span:4},{default:s(()=>[e[7]||(e[7]=o("p",{class:"label"},"Search Email:",-1)),t(l,{modelValue:a.value.email,"onUpdate:modelValue":e[2]||(e[2]=u=>a.value.email=u),placeholder:"Enter Email",clearable:""},null,8,["modelValue"])]),_:1}),t(m,{span:4},{default:s(()=>[e[8]||(e[8]=o("p",{class:"label"},"Filter by Status:",-1)),t(i,{modelValue:a.value.status,"onUpdate:modelValue":e[3]||(e[3]=u=>a.value.status=u),placeholder:"Select Status",clearable:""},{default:s(()=>[t(p,{label:"Success",value:"1"}),t(p,{label:"Failed",value:"0"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),o("div",$,[t(w,{type:"info",disabled:""},{default:s(()=>[...e[9]||(e[9]=[d("Import from CSV",-1)])]),_:1}),t(w,{type:"primary",onClick:O},{default:s(()=>[...e[10]||(e[10]=[d("Export to CSV",-1)])]),_:1})]),o("div",B,[t(R,{data:b.value,"tooltip-effect":"dark",style:{width:"100%",height:"100%"},"default-sort":{prop:"sent_at",order:"descending"}},{default:s(()=>[t(f,{prop:"order_id",label:"Order No","min-width":"150",align:"center",sortable:""}),t(f,{prop:"customer_name",label:"Customer Name","min-width":"120",align:"left",sortable:""}),t(f,{prop:"email",label:"Email","min-width":"200",align:"left",sortable:""}),t(f,{prop:"notification_name",label:"Notification Name","min-width":"200",align:"left"}),t(f,{label:"Status",width:"150",align:"center"},{default:s(u=>[t(x,{type:u.row.status==="1"?"success":"danger"},{default:s(()=>[d(T(u.row.status==="1"?"Success":"Unsuccessful"),1)]),_:2},1032,["type"])]),_:1}),t(f,{prop:"created_at",label:"Sent At","min-width":"200",sortable:""}),t(f,{label:"Operations",width:"120",align:"left"},{default:s(u=>[t(w,{type:"primary",size:"small",onClick:M=>L(u.row)},{default:s(()=>[...e[11]||(e[11]=[d("View",-1)])]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),t(U,{"model-value":r.value,width:n.dialogWidth,"custom-class":"responsive-dialog",onClose:e[4]||(e[4]=u=>r.value=!1)},{default:s(()=>[...e[12]||(e[12]=[o("h2",null,"Hi Christy Lewis,",-1),o("p",null,"Great news! Your order has been processed and is now on its way to you.",-1),o("div",{class:"order-details"},[o("h3",null,"Order Details:"),o("ul",null,[o("li",null,[o("strong",null,"Order Number:"),d(" ORORO#807250")]),o("li",null,[o("strong",null,"Tracking Number:"),d(" 1ZW656330326009081")]),o("li",null,[o("strong",null,"Carrier:"),d(" UPS")])])],-1),o("p",null,"We appreciate your patience as your order makes its way to you.",-1),o("p",null,[d("Thank you for choosing "),o("strong",null,"OROROWEAR"),d(".")],-1),o("p",{class:"footer"},[d(" If you have any questions, reply to this email or contact us at "),o("a",{href:"mailto:support@ororowear.com"},"support@ororowear.com"),d(". ")],-1)])]),_:1},8,["model-value","width"])])])}}},W=h(I,[["__scopeId","data-v-eaae7ee5"]]);const A={class:"page-container"},D={class:"container"},F={__name:"index",setup(N){const _=v([]);return C(async()=>{try{const b=(await g()).data.email_list||[];_.value=b.flat().map(r=>({store:r.store||"",order_id:r.order_id||"",customer_name:r.customer_name||"",courier:r.courier||"",tracking_no:r.tracking_no||r.tracking||"",status:r.status||"",delivery_status:r.delivery_status||"",created_at:r.created_at||"",operations:r.operations||""})),console.log("emailList:",_.value)}catch(a){console.error("获取邮件列表失败:",a.message)}}),(a,b)=>{const r=c("el-col"),y=c("el-row");return S(),V("div",A,[o("div",D,[t(y,{gutter:20,class:"table-list",justify:"center"},{default:s(()=>[t(r,{span:24},{default:s(()=>[t(W,{columns:["store","order_id","customer_name","courier","tracking_no","status","delivery_status","created_at","operations"],"order-list":_.value},null,8,["order-list"])]),_:1})]),_:1})])])}}},Oe=h(F,[["__scopeId","data-v-46088aa7"]]);export{Oe as default};
