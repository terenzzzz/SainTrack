function q(t){return t.split("-")[1]}function rt(t){return t==="y"?"height":"width"}function B(t){return t.split("-")[0]}function G(t){return["top","bottom"].includes(B(t))?"x":"y"}function at(t,e,o){let{reference:n,floating:c}=t;const l=n.x+n.width/2-c.width/2,i=n.y+n.height/2-c.height/2,r=G(e),f=rt(r),a=n[f]/2-c[f]/2,m=r==="x";let s;switch(B(e)){case"top":s={x:l,y:n.y-c.height};break;case"bottom":s={x:l,y:n.y+n.height};break;case"right":s={x:n.x+n.width,y:i};break;case"left":s={x:n.x-c.width,y:i};break;default:s={x:n.x,y:n.y}}switch(q(e)){case"start":s[r]-=a*(o&&m?-1:1);break;case"end":s[r]+=a*(o&&m?-1:1)}return s}const Dt=async(t,e,o)=>{const{placement:n="bottom",strategy:c="absolute",middleware:l=[],platform:i}=o,r=l.filter(Boolean),f=await(i.isRTL==null?void 0:i.isRTL(e));let a=await i.getElementRects({reference:t,floating:e,strategy:c}),{x:m,y:s}=at(a,n,f),d=n,u={},h=0;for(let p=0;p<r.length;p++){const{name:g,fn:x}=r[p],{x:y,y:w,data:R,reset:b}=await x({x:m,y:s,initialPlacement:n,placement:d,strategy:c,middlewareData:u,rects:a,platform:i,elements:{reference:t,floating:e}});m=y??m,s=w??s,u={...u,[g]:{...u[g],...R}},b&&h<=50&&(h++,typeof b=="object"&&(b.placement&&(d=b.placement),b.rects&&(a=b.rects===!0?await i.getElementRects({reference:t,floating:e,strategy:c}):b.rects),{x:m,y:s}=at(a,d,f)),p=-1)}return{x:m,y:s,placement:d,strategy:c,middlewareData:u}};function pt(t){return typeof t!="number"?function(e){return{top:0,right:0,bottom:0,left:0,...e}}(t):{top:t,right:t,bottom:t,left:t}}function J(t){return{...t,top:t.y,left:t.x,right:t.x+t.width,bottom:t.y+t.height}}async function gt(t,e){var o;e===void 0&&(e={});const{x:n,y:c,platform:l,rects:i,elements:r,strategy:f}=t,{boundary:a="clippingAncestors",rootBoundary:m="viewport",elementContext:s="floating",altBoundary:d=!1,padding:u=0}=e,h=pt(u),p=r[d?s==="floating"?"reference":"floating":s],g=J(await l.getClippingRect({element:(o=await(l.isElement==null?void 0:l.isElement(p)))==null||o?p:p.contextElement||await(l.getDocumentElement==null?void 0:l.getDocumentElement(r.floating)),boundary:a,rootBoundary:m,strategy:f})),x=s==="floating"?{...i.floating,x:n,y:c}:i.reference,y=await(l.getOffsetParent==null?void 0:l.getOffsetParent(r.floating)),w=await(l.isElement==null?void 0:l.isElement(y))&&await(l.getScale==null?void 0:l.getScale(y))||{x:1,y:1},R=J(l.convertOffsetParentRelativeRectToViewportRelativeRect?await l.convertOffsetParentRelativeRectToViewportRelativeRect({rect:x,offsetParent:y,strategy:f}):x);return{top:(g.top-R.top+h.top)/w.y,bottom:(R.bottom-g.bottom+h.bottom)/w.y,left:(g.left-R.left+h.left)/w.x,right:(R.right-g.right+h.right)/w.x}}const $t=Math.min,Pt=Math.max;function nt(t,e,o){return Pt(t,$t(e,o))}const Bt=t=>({name:"arrow",options:t,async fn(e){const{element:o,padding:n=0}=t||{},{x:c,y:l,placement:i,rects:r,platform:f,elements:a}=e;if(o==null)return{};const m=pt(n),s={x:c,y:l},d=G(i),u=rt(d),h=await f.getDimensions(o),p=d==="y",g=p?"top":"left",x=p?"bottom":"right",y=p?"clientHeight":"clientWidth",w=r.reference[u]+r.reference[d]-s[d]-r.floating[u],R=s[d]-r.reference[d],b=await(f.getOffsetParent==null?void 0:f.getOffsetParent(o));let k=b?b[y]:0;k&&await(f.isElement==null?void 0:f.isElement(b))||(k=a.floating[y]||r.floating[u]);const W=w/2-R/2,H=m[g],N=k-h[u]-m[x],$=k/2-h[u]/2+W,v=nt(H,$,N),T=q(i)!=null&&$!=v&&r.reference[u]/2-($<H?m[g]:m[x])-h[u]/2<0;return{[d]:s[d]-(T?$<H?H-$:N-$:0),data:{[d]:v,centerOffset:$-v}}}}),kt=["top","right","bottom","left"];kt.reduce((t,e)=>t.concat(e,e+"-start",e+"-end"),[]);const Ct={left:"right",right:"left",bottom:"top",top:"bottom"};function K(t){return t.replace(/left|right|bottom|top/g,e=>Ct[e])}function Ft(t,e,o){o===void 0&&(o=!1);const n=q(t),c=G(t),l=rt(c);let i=c==="x"?n===(o?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[l]>e.floating[l]&&(i=K(i)),{main:i,cross:K(i)}}const Ot={start:"end",end:"start"};function et(t){return t.replace(/start|end/g,e=>Ot[e])}const Mt=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var o;const{placement:n,middlewareData:c,rects:l,initialPlacement:i,platform:r,elements:f}=e,{mainAxis:a=!0,crossAxis:m=!0,fallbackPlacements:s,fallbackStrategy:d="bestFit",fallbackAxisSideDirection:u="none",flipAlignment:h=!0,...p}=t,g=B(n),x=B(i)===i,y=await(r.isRTL==null?void 0:r.isRTL(f.floating)),w=s||(x||!h?[K(i)]:function(v){const T=K(v);return[et(v),T,et(T)]}(i));s||u==="none"||w.push(...function(v,T,V,F){const C=q(v);let E=function(j,tt,Et){const ct=["left","right"],st=["right","left"],Tt=["top","bottom"],At=["bottom","top"];switch(j){case"top":case"bottom":return Et?tt?st:ct:tt?ct:st;case"left":case"right":return tt?Tt:At;default:return[]}}(B(v),V==="start",F);return C&&(E=E.map(j=>j+"-"+C),T&&(E=E.concat(E.map(et)))),E}(i,h,u,y));const R=[i,...w],b=await gt(e,p),k=[];let W=((o=c.flip)==null?void 0:o.overflows)||[];if(a&&k.push(b[g]),m){const{main:v,cross:T}=Ft(n,l,y);k.push(b[v],b[T])}if(W=[...W,{placement:n,overflows:k}],!k.every(v=>v<=0)){var H,N;const v=(((H=c.flip)==null?void 0:H.index)||0)+1,T=R[v];if(T)return{data:{index:v,overflows:W},reset:{placement:T}};let V=(N=W.filter(F=>F.overflows[0]<=0).sort((F,C)=>F.overflows[1]-C.overflows[1])[0])==null?void 0:N.placement;if(!V)switch(d){case"bestFit":{var $;const F=($=W.map(C=>[C.placement,C.overflows.filter(E=>E>0).reduce((E,j)=>E+j,0)]).sort((C,E)=>C[1]-E[1])[0])==null?void 0:$[0];F&&(V=F);break}case"initialPlacement":V=i}if(n!==V)return{reset:{placement:V}}}return{}}}},zt=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){const{x:o,y:n}=e,c=await async function(l,i){const{placement:r,platform:f,elements:a}=l,m=await(f.isRTL==null?void 0:f.isRTL(a.floating)),s=B(r),d=q(r),u=G(r)==="x",h=["left","top"].includes(s)?-1:1,p=m&&u?-1:1,g=typeof i=="function"?i(l):i;let{mainAxis:x,crossAxis:y,alignmentAxis:w}=typeof g=="number"?{mainAxis:g,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...g};return d&&typeof w=="number"&&(y=d==="end"?-1*w:w),u?{x:y*p,y:x*h}:{x:x*h,y:y*p}}(e,t);return{x:o+c.x,y:n+c.y,data:c}}}};function St(t){return t==="x"?"y":"x"}const Nt=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:o,y:n,placement:c}=e,{mainAxis:l=!0,crossAxis:i=!1,limiter:r={fn:g=>{let{x,y}=g;return{x,y}}},...f}=t,a={x:o,y:n},m=await gt(e,f),s=G(B(c)),d=St(s);let u=a[s],h=a[d];if(l){const g=s==="y"?"bottom":"right";u=nt(u+m[s==="y"?"top":"left"],u,u-m[g])}if(i){const g=d==="y"?"bottom":"right";h=nt(h+m[d==="y"?"top":"left"],h,h-m[g])}const p=r.fn({...e,[s]:u,[d]:h});return{...p,data:{x:p.x-o,y:p.y-n}}}}};function L(t){var e;return((e=t.ownerDocument)==null?void 0:e.defaultView)||window}function P(t){return L(t).getComputedStyle(t)}function yt(t){return t instanceof L(t).Node}function S(t){return yt(t)?(t.nodeName||"").toLowerCase():""}let I;function xt(){if(I)return I;const t=navigator.userAgentData;return t&&Array.isArray(t.brands)?(I=t.brands.map(e=>e.brand+"/"+e.version).join(" "),I):navigator.userAgent}function D(t){return t instanceof L(t).HTMLElement}function A(t){return t instanceof L(t).Element}function ft(t){return typeof ShadowRoot>"u"?!1:t instanceof L(t).ShadowRoot||t instanceof ShadowRoot}function U(t){const{overflow:e,overflowX:o,overflowY:n,display:c}=P(t);return/auto|scroll|overlay|hidden|clip/.test(e+n+o)&&!["inline","contents"].includes(c)}function Wt(t){return["table","td","th"].includes(S(t))}function ot(t){const e=/firefox/i.test(xt()),o=P(t),n=o.backdropFilter||o.WebkitBackdropFilter;return o.transform!=="none"||o.perspective!=="none"||!!n&&n!=="none"||e&&o.willChange==="filter"||e&&!!o.filter&&o.filter!=="none"||["transform","perspective"].some(c=>o.willChange.includes(c))||["paint","layout","strict","content"].some(c=>{const l=o.contain;return l!=null&&l.includes(c)})}function it(){return/^((?!chrome|android).)*safari/i.test(xt())}function lt(t){return["html","body","#document"].includes(S(t))}const ut=Math.min,X=Math.max,Q=Math.round;function wt(t){const e=P(t);let o=parseFloat(e.width),n=parseFloat(e.height);const c=D(t),l=c?t.offsetWidth:o,i=c?t.offsetHeight:n,r=Q(o)!==l||Q(n)!==i;return r&&(o=l,n=i),{width:o,height:n,fallback:r}}function vt(t){return A(t)?t:t.contextElement}const bt={x:1,y:1};function z(t){const e=vt(t);if(!D(e))return bt;const o=e.getBoundingClientRect(),{width:n,height:c,fallback:l}=wt(e);let i=(l?Q(o.width):o.width)/n,r=(l?Q(o.height):o.height)/c;return i&&Number.isFinite(i)||(i=1),r&&Number.isFinite(r)||(r=1),{x:i,y:r}}function M(t,e,o,n){var c,l;e===void 0&&(e=!1),o===void 0&&(o=!1);const i=t.getBoundingClientRect(),r=vt(t);let f=bt;e&&(n?A(n)&&(f=z(n)):f=z(t));const a=r?L(r):window,m=it()&&o;let s=(i.left+(m&&((c=a.visualViewport)==null?void 0:c.offsetLeft)||0))/f.x,d=(i.top+(m&&((l=a.visualViewport)==null?void 0:l.offsetTop)||0))/f.y,u=i.width/f.x,h=i.height/f.y;if(r){const p=L(r),g=n&&A(n)?L(n):n;let x=p.frameElement;for(;x&&n&&g!==p;){const y=z(x),w=x.getBoundingClientRect(),R=getComputedStyle(x);w.x+=(x.clientLeft+parseFloat(R.paddingLeft))*y.x,w.y+=(x.clientTop+parseFloat(R.paddingTop))*y.y,s*=y.x,d*=y.y,u*=y.x,h*=y.y,s+=w.x,d+=w.y,x=L(x).frameElement}}return J({width:u,height:h,x:s,y:d})}function O(t){return((yt(t)?t.ownerDocument:t.document)||window.document).documentElement}function Z(t){return A(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function Rt(t){return M(O(t)).left+Z(t).scrollLeft}function _(t){if(S(t)==="html")return t;const e=t.assignedSlot||t.parentNode||ft(t)&&t.host||O(t);return ft(e)?e.host:e}function Lt(t){const e=_(t);return lt(e)?e.ownerDocument.body:D(e)&&U(e)?e:Lt(e)}function Y(t,e){var o;e===void 0&&(e=[]);const n=Lt(t),c=n===((o=t.ownerDocument)==null?void 0:o.body),l=L(n);return c?e.concat(l,l.visualViewport||[],U(n)?n:[]):e.concat(n,Y(n))}function dt(t,e,o){let n;if(e==="viewport")n=function(i,r){const f=L(i),a=O(i),m=f.visualViewport;let s=a.clientWidth,d=a.clientHeight,u=0,h=0;if(m){s=m.width,d=m.height;const p=it();(!p||p&&r==="fixed")&&(u=m.offsetLeft,h=m.offsetTop)}return{width:s,height:d,x:u,y:h}}(t,o);else if(e==="document")n=function(i){const r=O(i),f=Z(i),a=i.ownerDocument.body,m=X(r.scrollWidth,r.clientWidth,a.scrollWidth,a.clientWidth),s=X(r.scrollHeight,r.clientHeight,a.scrollHeight,a.clientHeight);let d=-f.scrollLeft+Rt(i);const u=-f.scrollTop;return P(a).direction==="rtl"&&(d+=X(r.clientWidth,a.clientWidth)-m),{width:m,height:s,x:d,y:u}}(O(t));else if(A(e))n=function(i,r){const f=M(i,!0,r==="fixed"),a=f.top+i.clientTop,m=f.left+i.clientLeft,s=D(i)?z(i):{x:1,y:1};return{width:i.clientWidth*s.x,height:i.clientHeight*s.y,x:m*s.x,y:a*s.y}}(e,o);else{const i={...e};if(it()){var c,l;const r=L(t);i.x-=((c=r.visualViewport)==null?void 0:c.offsetLeft)||0,i.y-=((l=r.visualViewport)==null?void 0:l.offsetTop)||0}n=i}return J(n)}function mt(t,e){return D(t)&&P(t).position!=="fixed"?e?e(t):t.offsetParent:null}function ht(t,e){const o=L(t);if(!D(t))return o;let n=mt(t,e);for(;n&&Wt(n)&&P(n).position==="static";)n=mt(n,e);return n&&(S(n)==="html"||S(n)==="body"&&P(n).position==="static"&&!ot(n))?o:n||function(c){let l=_(c);for(;D(l)&&!lt(l);){if(ot(l))return l;l=_(l)}return null}(t)||o}function Ht(t,e,o){const n=D(e),c=O(e),l=M(t,!0,o==="fixed",e);let i={scrollLeft:0,scrollTop:0};const r={x:0,y:0};if(n||!n&&o!=="fixed")if((S(e)!=="body"||U(c))&&(i=Z(e)),D(e)){const f=M(e,!0);r.x=f.x+e.clientLeft,r.y=f.y+e.clientTop}else c&&(r.x=Rt(c));return{x:l.left+i.scrollLeft-r.x,y:l.top+i.scrollTop-r.y,width:l.width,height:l.height}}const Vt={getClippingRect:function(t){let{element:e,boundary:o,rootBoundary:n,strategy:c}=t;const l=o==="clippingAncestors"?function(a,m){const s=m.get(a);if(s)return s;let d=Y(a).filter(g=>A(g)&&S(g)!=="body"),u=null;const h=P(a).position==="fixed";let p=h?_(a):a;for(;A(p)&&!lt(p);){const g=P(p),x=ot(p);g.position==="fixed"?u=null:(h?x||u:x||g.position!=="static"||!u||!["absolute","fixed"].includes(u.position))?u=g:d=d.filter(y=>y!==p),p=_(p)}return m.set(a,d),d}(e,this._c):[].concat(o),i=[...l,n],r=i[0],f=i.reduce((a,m)=>{const s=dt(e,m,c);return a.top=X(s.top,a.top),a.right=ut(s.right,a.right),a.bottom=ut(s.bottom,a.bottom),a.left=X(s.left,a.left),a},dt(e,r,c));return{width:f.right-f.left,height:f.bottom-f.top,x:f.left,y:f.top}},convertOffsetParentRelativeRectToViewportRelativeRect:function(t){let{rect:e,offsetParent:o,strategy:n}=t;const c=D(o),l=O(o);if(o===l)return e;let i={scrollLeft:0,scrollTop:0},r={x:1,y:1};const f={x:0,y:0};if((c||!c&&n!=="fixed")&&((S(o)!=="body"||U(l))&&(i=Z(o)),D(o))){const a=M(o);r=z(o),f.x=a.x+o.clientLeft,f.y=a.y+o.clientTop}return{width:e.width*r.x,height:e.height*r.y,x:e.x*r.x-i.scrollLeft*r.x+f.x,y:e.y*r.y-i.scrollTop*r.y+f.y}},isElement:A,getDimensions:function(t){return wt(t)},getOffsetParent:ht,getDocumentElement:O,getScale:z,async getElementRects(t){let{reference:e,floating:o,strategy:n}=t;const c=this.getOffsetParent||ht,l=this.getDimensions;return{reference:Ht(e,await c(o),n),floating:{x:0,y:0,...await l(o)}}},getClientRects:t=>Array.from(t.getClientRects()),isRTL:t=>P(t).direction==="rtl"};function jt(t,e,o,n){n===void 0&&(n={});const{ancestorScroll:c=!0,ancestorResize:l=!0,elementResize:i=!0,animationFrame:r=!1}=n,f=c&&!r,a=f||l?[...A(t)?Y(t):t.contextElement?Y(t.contextElement):[],...Y(e)]:[];a.forEach(u=>{f&&u.addEventListener("scroll",o,{passive:!0}),l&&u.addEventListener("resize",o)});let m,s=null;i&&(s=new ResizeObserver(()=>{o()}),A(t)&&!r&&s.observe(t),A(t)||!t.contextElement||r||s.observe(t.contextElement),s.observe(e));let d=r?M(t):null;return r&&function u(){const h=M(t);!d||h.x===d.x&&h.y===d.y&&h.width===d.width&&h.height===d.height||o(),d=h,m=requestAnimationFrame(u)}(),o(),()=>{var u;a.forEach(h=>{f&&h.removeEventListener("scroll",o),l&&h.removeEventListener("resize",o)}),(u=s)==null||u.disconnect(),s=null,r&&cancelAnimationFrame(m)}}const Xt=(t,e,o)=>{const n=new Map,c={platform:Vt,...o},l={...c.platform,_c:n};return Dt(t,e,{...c,platform:l})};export{zt as D,jt as P,Mt as b,Nt as k,gt as s,Bt as u,Xt as z};
